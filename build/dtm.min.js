function weightTfIdf(a){for(var b=[],c=0;c<a[0].length;c++){for(var d=0,e=0;e<a.length;e++)void 0!==a[e][c]&&d++;b.push(d)}for(var f=0;f<a.length;f++)for(var g=0;g<a[0].length;g++){var h=Math.log(a.length)-Math.log(1+b[g]);void 0!==a[f][g]&&(a[f][g]=a[f][g]*h)}return a}var Terms=function(a){if(!(this instanceof Terms))return new Terms(a);var b=this;this.vocabulary=[],this.dtm=[],Object.defineProperty(this,"nDocs",{get:function(){return this.dtm.length},enumerable:!0}),Object.defineProperty(this,"nTerms",{get:function(){return this.vocabulary.length},enumerable:!0}),this.fill_zeros=function(){for(var a=0;a<b.dtm.length;a++)for(var c=0;c<b.dtm[0].length;c++)void 0===b.dtm[a][c]&&(b.dtm[a][c]=0);return b};var c=function(a){for(var c=a.split(" "),d=[],e=0;e<c.length;e++){var f=c[e],g=b.vocabulary.indexOf(f);g>-1?d[g]=d[g]+1||1:(d[b.vocabulary.length]=1,b.vocabulary.push(f))}b.dtm.push(d)},d=function(a){var c=b.dtm.map(function(b){return b[a]||0}),d=c.reduce(function(a,b){return a+b});return d};this.findFreqTerms=function(a){for(var c=[],e=0;e<b.vocabulary.length;e++){var f=d(e),g={};g.word=b.vocabulary[e],g.count=f,f>=a&&c.push(g)}var h=_.sortBy(c,function(a){return a.word});return h},this.removeSparseTerms=function(a){for(var c=[],d=0;d<b.vocabulary.length;d++){for(var e=0,f=0;f<b.dtm.length;f++){var g=b.dtm[f];void 0!==g&&void 0!==g[d]&&e++}e/b.dtm.length<a&&c.push(d)}for(var h=c.length-1;h>=0;h--){var i=c[h];b.vocabulary.splice(i,1);for(var j=0;j<b.dtm.length;j++)b.dtm[j].splice(i,1)}return b},this.weighting=function(a){return b.dtm=a(b.dtm),b},function(){var d=a.documents;d.forEach(c),b.dtm.forEach(function(a){a.length=b.vocabulary.length})}()};exports.Terms=Terms,exports.weightTfIdf=weightTfIdf;